/*
 * Playlist Object for the jPlayer Plugin
 * http://www.jplayer.org
 *
 * Copyright (c) 2009 - 2011 Happyworm Ltd
 * Dual licensed under the MIT and GPL licenses.
 *  - http://www.opensource.org/licenses/mit-license.php
 *  - http://www.gnu.org/copyleft/gpl.html
 *
 * Author: Mark J Panaghiston
 * Version: 2.1.0 (jPlayer 2.1.0)
 * Date: 1st September 2011
 */
!function(t,e){jPlayerPlaylist=function(e,n,i){var o=this;this.current=0,this.removing=this.shuffled=this.loop=!1,this.cssSelector=t.extend({},this._cssSelector,e),this.options=t.extend(!0,{},this._options,i),this.playlist=[],this.original=[],this._initPlaylist(n),this.cssSelector.title=this.cssSelector.cssSelectorAncestor+" .jp-title",this.cssSelector.playlist=this.cssSelector.cssSelectorAncestor+" .jp-playlist",this.cssSelector.next=this.cssSelector.cssSelectorAncestor+" .jp-next",this.cssSelector.previous=this.cssSelector.cssSelectorAncestor+" .jp-previous",this.cssSelector.shuffle=this.cssSelector.cssSelectorAncestor+" .jp-shuffle",this.cssSelector.shuffleOff=this.cssSelector.cssSelectorAncestor+" .jp-shuffle-off",this.options.cssSelectorAncestor=this.cssSelector.cssSelectorAncestor,this.options.repeat=function(t){o.loop=t.jPlayer.options.loop},t(this.cssSelector.jPlayer).bind(t.jPlayer.event.ready,function(){o._init()}),t(this.cssSelector.jPlayer).bind(t.jPlayer.event.ended,function(){o.next()}),t(this.cssSelector.jPlayer).bind(t.jPlayer.event.play,function(){t(this).jPlayer("pauseOthers")}),t(this.cssSelector.jPlayer).bind(t.jPlayer.event.resize,function(e){e.jPlayer.options.fullScreen?t(o.cssSelector.title).show():t(o.cssSelector.title).hide()}),t(this.cssSelector.previous).click(function(){return o.previous(),t(this).blur(),!1}),t(this.cssSelector.next).click(function(){return o.next(),t(this).blur(),!1}),t(this.cssSelector.shuffle).click(function(){return o.shuffle(!0),!1}),t(this.cssSelector.shuffleOff).click(function(){return o.shuffle(!1),!1}).hide(),this.options.fullScreen||t(this.cssSelector.title).hide(),t(this.cssSelector.playlist+" ul").empty(),this._createItemHandlers(),t(this.cssSelector.jPlayer).jPlayer(this.options)},jPlayerPlaylist.prototype={_cssSelector:{jPlayer:"#jquery_jplayer_1",cssSelectorAncestor:"#jp_container_1"},_options:{playlistOptions:{autoPlay:!1,loopOnPrevious:!1,shuffleOnLoop:!0,enableRemoveControls:!1,displayTime:"slow",addTime:"fast",removeTime:"fast",shuffleTime:"slow",itemClass:"jp-playlist-item",freeGroupClass:"jp-free-media",freeItemClass:"jp-playlist-item-free",removeItemClass:"jp-playlist-item-remove"}},option:function(t,n){if(n===e)return this.options.playlistOptions[t];switch(this.options.playlistOptions[t]=n,t){case"enableRemoveControls":this._updateControls();break;case"itemClass":case"freeGroupClass":case"freeItemClass":case"removeItemClass":this._refresh(!0),this._createItemHandlers()}return this},_init:function(){var t=this;this._refresh(function(){t.options.playlistOptions.autoPlay?t.play(t.current):t.select(t.current)})},_initPlaylist:function(e){this.current=0,this.removing=this.shuffled=!1,this.original=t.extend(!0,[],e),this._originalPlaylist()},_originalPlaylist:function(){var e=this;this.playlist=[],t.each(this.original,function(t){e.playlist[t]=e.original[t]})},_refresh:function(e){var n=this;if(e&&!t.isFunction(e))t(this.cssSelector.playlist+" ul").empty(),t.each(this.playlist,function(e){t(n.cssSelector.playlist+" ul").append(n._createListItem(n.playlist[e]))}),this._updateControls();else{var i=t(this.cssSelector.playlist+" ul").children().length?this.options.playlistOptions.displayTime:0;t(this.cssSelector.playlist+" ul").slideUp(i,function(){var i=t(this);t(this).empty(),t.each(n.playlist,function(t){i.append(n._createListItem(n.playlist[t]))}),n._updateControls(),t.isFunction(e)&&e(),n.playlist.length?t(this).slideDown(n.options.playlistOptions.displayTime):t(this).show()})}},_createListItem:function(e){var n=this,i="<li><div>";if(i+="<a href='javascript:;' class='"+this.options.playlistOptions.removeItemClass+"'>&times;</a>",e.free){var o=!0;i+="<span class='"+this.options.playlistOptions.freeGroupClass+"'>",t.each(e,function(e,s){t.jPlayer.prototype.format[e]&&(o?o=!1:i+=" | ",i+="<a class='"+n.options.playlistOptions.freeItemClass+"' href='"+s+"' tabindex='1'></a>")}),i+="</span>"}return i+="<a href='javascript:;' class='"+this.options.playlistOptions.itemClass+"' tabindex='1'>"+e.title+(e.artist?" <span class='jp-artist'>by "+e.artist+"</span>":"")+"</a>",i+="</div></li>"},_createItemHandlers:function(){var e=this;t(this.cssSelector.playlist+" a."+this.options.playlistOptions.itemClass).die("click").live("click",function(){var n=t(this).parent().parent().index();return e.current!==n?e.play(n):t(e.cssSelector.jPlayer).jPlayer("play"),t(this).blur(),!1}),t(e.cssSelector.playlist+" a."+this.options.playlistOptions.freeItemClass).die("click").live("click",function(){return t(this).parent().parent().find("."+e.options.playlistOptions.itemClass).click(),t(this).blur(),!1}),t(e.cssSelector.playlist+" a."+this.options.playlistOptions.removeItemClass).die("click").live("click",function(){var n=t(this).parent().parent().index();return e.remove(n),t(this).blur(),!1})},_updateControls:function(){this.options.playlistOptions.enableRemoveControls?t(this.cssSelector.playlist+" ."+this.options.playlistOptions.removeItemClass).show():t(this.cssSelector.playlist+" ."+this.options.playlistOptions.removeItemClass).hide(),this.shuffled?(t(this.cssSelector.shuffleOff).show(),t(this.cssSelector.shuffle).hide()):(t(this.cssSelector.shuffleOff).hide(),t(this.cssSelector.shuffle).show())},_highlight:function(n){this.playlist.length&&n!==e&&(t(this.cssSelector.playlist+" .jp-playlist-current").removeClass("jp-playlist-current"),t(this.cssSelector.playlist+" li:nth-child("+(n+1)+")").addClass("jp-playlist-current").find(".jp-playlist-item").addClass("jp-playlist-current"),t(this.cssSelector.title+" li").html(this.playlist[n].title+(this.playlist[n].artist?" <span class='jp-artist'>by "+this.playlist[n].artist+"</span>":"")))},setPlaylist:function(t){this._initPlaylist(t),this._init()},add:function(e,n){t(this.cssSelector.playlist+" ul").append(this._createListItem(e)).find("li:last-child").hide().slideDown(this.options.playlistOptions.addTime),this._updateControls(),this.original.push(e),this.playlist.push(e),n?this.play(this.playlist.length-1):1===this.original.length&&this.select(0)},remove:function(n){var i=this;return n===e?(this._initPlaylist([]),this._refresh(function(){t(i.cssSelector.jPlayer).jPlayer("clearMedia")}),!0):this.removing?!1:(n=0>n?i.original.length+n:n,n>=0&&n<this.playlist.length&&(this.removing=!0,t(this.cssSelector.playlist+" li:nth-child("+(n+1)+")").slideUp(this.options.playlistOptions.removeTime,function(){if(t(this).remove(),i.shuffled){var e=i.playlist[n];t.each(i.original,function(t){return i.original[t]===e?(i.original.splice(t,1),!1):void 0})}else i.original.splice(n,1);i.playlist.splice(n,1),i.original.length?n===i.current?(i.current=n<i.original.length?i.current:i.original.length-1,i.select(i.current)):n<i.current&&i.current--:(t(i.cssSelector.jPlayer).jPlayer("clearMedia"),i.current=0,i.shuffled=!1,i._updateControls()),i.removing=!1})),!0)},select:function(e){e=0>e?this.original.length+e:e,e>=0&&e<this.playlist.length?(this.current=e,this._highlight(e),t(this.cssSelector.jPlayer).jPlayer("setMedia",this.playlist[this.current])):this.current=0},play:function(n){n=0>n?this.original.length+n:n,n>=0&&n<this.playlist.length?this.playlist.length&&(this.select(n),t(this.cssSelector.jPlayer).jPlayer("play")):n===e&&t(this.cssSelector.jPlayer).jPlayer("play")},pause:function(){t(this.cssSelector.jPlayer).jPlayer("pause")},next:function(){var t=this.current+1<this.playlist.length?this.current+1:0;this.loop?0===t&&this.shuffled&&this.options.playlistOptions.shuffleOnLoop&&this.playlist.length>1?this.shuffle(!0,!0):this.play(t):t>0&&this.play(t)},previous:function(){var t=this.current-1>=0?this.current-1:this.playlist.length-1;(this.loop&&this.options.playlistOptions.loopOnPrevious||t<this.playlist.length-1)&&this.play(t)},shuffle:function(n,i){var o=this;n===e&&(n=!this.shuffled),(n||n!==this.shuffled)&&t(this.cssSelector.playlist+" ul").slideUp(this.options.playlistOptions.shuffleTime,function(){(o.shuffled=n)?o.playlist.sort(function(){return.5-Math.random()}):o._originalPlaylist(),o._refresh(!0),i||!t(o.cssSelector.jPlayer).data("jPlayer").status.paused?o.play(0):o.select(0),t(this).slideDown(o.options.playlistOptions.shuffleTime)})}}}(jQuery);